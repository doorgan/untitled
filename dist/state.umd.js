!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n||self).untitled={})}(this,function(n){var t=function(n,t){switch(n){case 0:return function(){return t.apply(this,arguments)};case 1:return function(n){return t.apply(this,arguments)};case 2:return function(n,e){return t.apply(this,arguments)};case 3:return function(n,e,r){return t.apply(this,arguments)};case 4:return function(n,e,r,u){return t.apply(this,arguments)};case 5:return function(n,e,r,u,o){return t.apply(this,arguments)};case 6:return function(n,e,r,u,o,s){return t.apply(this,arguments)};case 7:return function(n,e,r,u,o,s,i){return t.apply(this,arguments)};case 8:return function(n,e,r,u,o,s,i,a){return t.apply(this,arguments)};case 9:return function(n,e,r,u,o,s,i,a,f){return t.apply(this,arguments)};case 10:return function(n,e,r,u,o,s,i,a,f,c){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},e=function(n){return null!=n&&"object"==typeof n&&!0===n["@@functional/placeholder"]},r=function(n){return function t(r){return 0===arguments.length||e(r)?t:n.apply(this,arguments)}},u=function n(r,u,o){return function(){for(var s=[],i=0,a=r,f=0;f<u.length||i<arguments.length;){var c;f<u.length&&(!e(u[f])||i>=arguments.length)?c=u[f]:(c=arguments[i],i+=1),s[f]=c,e(c)||(a-=1),f+=1}return a<=0?o.apply(this,s):t(a,n(r,s,o))}},o=function(n){return function t(u,o){switch(arguments.length){case 0:return t;case 1:return e(u)?t:r(function(t){return n(u,t)});default:return e(u)&&e(o)?t:e(u)?r(function(t){return n(t,o)}):e(o)?r(function(t){return n(u,t)}):n(u,o)}}}(function(n,e){return 1===n?r(e):t(n,u(n,[],e))});function s(){return!0}var i,a=[],f=[],c=-1,d=!1,l=!1,p={};function h(n,t){var e,r,u,o,i=V([],s);for(u=[],o=[],e=0;e<t.length;++e)void 0!==t[e]&&(u.push(t[e]),void 0!==t[e].end&&o.push(t[e].end));return(r=V(u,n)).depsChanged=[],r.fnArgs=r.deps.concat([r,r.depsChanged]),r.end=i,i.listeners.push(r),E(o,i),i.deps=o,M(r),r}function v(n,t){return h(function(t,e){e(n(t.val))},[t])}function g(n){return v(n,this)}function y(n){return n(this)}function m(n){return b(n,this)}function b(n,t){var e=p.stream(1),r=p.on(function(){var n=e()-1;e(n),n<=0&&e.end(!0)});r(t.end);var u=p.stream(),o=p.combine(function(t,o){u.end(!0);var s=n(t());e(e()+1),r(s.end),u=v(o,s)},[t]);return p.endsOn(e.end,o),o}function A(n,t){return h(function(n,t,e){e(n.val(t.val))},[t,n])}function C(n){return A(n,this)}function j(n){return A(this,n)}function O(){return"stream("+this.val+")"}function U(){function n(t){return 0===arguments.length?n.val:(N(t,n),n)}return n.hasVal=!1,n.val=void 0,n.updaters=[],n.listeners=[],n.queued=!1,n.end=void 0,n.ap=C,n["fantasy-land/map"]=n.map=g,n["fantasy-land/ap"]=j,n["fantasy-land/of"]=n.of=p.stream,n["fantasy-land/chain"]=n.chain=m,n.pipe=y,n.constructor=p.stream,n.toJSON=function(){return n.val},n.toString=O,n}function V(n,t){var e=U();return e.fn=t,e.deps=n,e.depsMet=!1,e.depsChanged=n.length>0?[]:void 0,e.shouldUpdate=!1,E(n,e),e}function M(n){if(!function(n){return n.end&&!0===n.end.val}(n)&&function(n){return!0===n.depsMet||function(n){return n.depsMet=n.deps.every(function(n){return n.hasVal}),n.depsMet}(n)}(n))if(void 0===i){i=n,n.depsChanged&&(n.fnArgs[n.fnArgs.length-1]=n.depsChanged);var t=n.fn.apply(n.fn,n.fnArgs);void 0!==t&&n(t),i=void 0,void 0!==n.depsChanged&&(n.depsChanged=[]),n.shouldUpdate=!1,!1===(d||l)&&x(),function(n){return n.listeners.some(function(n){return n.shouldUpdate})}(n)&&(l?n.listeners.forEach(function(n){n.shouldUpdate&&q(M,n)}):n(n.val))}else q(M,n)}function w(n){var t,e=n.listeners;if(!1===n.queued){for(n.queued=!0,t=0;t<e.length;++t)w(e[t]);f[++c]=n}}function q(n,t){a.push(t),t.updaters.push(n),t.shouldUpdate=!0}function x(){for(d=!0;a.length>0;){var n=a.shift(),t=n.updaters.shift();t&&n.shouldUpdate&&t(n)}d=!1}function N(n,t){t.val=n,t.hasVal=!0,void 0===i?(l=!0,function(n){var t,e,r,u=n.listeners;for(t=0;t<u.length;++t)(r=u[t]).end===n?P(r):(void 0!==r.depsChanged&&r.depsChanged.push(n),r.shouldUpdate=!0,w(r));for(;c>=0;--c)!0===(e=f[c]).shouldUpdate&&M(e),e.queued=!1}(t),a.length>0&&x(),l=!1):i===t?function(n,t){var e,r;for(e=0;e<t.length;++e)(r=t[e]).end!==n?(void 0!==r.depsChanged&&r.depsChanged.push(n),r.shouldUpdate=!0):P(r)}(t,t.listeners):q(function(t){N(n,t)},t)}function E(n,t){for(var e=0;e<n.length;++e)n[e].listeners.push(t)}function S(n,t){var e=t.indexOf(n);t[e]=t[t.length-1],t.length--}function k(n){for(var t=0;t<n.deps.length;++t)S(n,n.deps[t].listeners);n.deps.length=0}function P(n){void 0!==n.deps&&k(n),void 0!==n.end&&k(n.end)}function T(){}p.stream=function(n){var t=V([],s),e=U();return e.end=t,e.fnArgs=[],t.listeners.push(e),arguments.length>0&&e(n),e},p.stream["fantasy-land/of"]=p.stream.of=p.stream,p.combine=o(2,h),p.isStream=function(n){return!!((t=n)&&t.constructor&&t.call&&t.apply)&&"hasVal"in n;var t},p.immediate=function(n){return!1===n.depsMet&&(n.depsMet=!0,M(n)),n},p.endsOn=function(n,t){return k(t.end),n.listeners.push(t.end),t.end.deps.push(n),t},p.map=o(2,v),p.chain=o(2,b),p.ap=o(2,A),p.on=o(2,function(n,t){return h(function(t){n(t.val)},[t])}),p.scan=o(3,function(n,t,e){var r=h(function(e,r){r(t=n(t,e.val))},[e]);return r.hasVal||r(t),r}),p.merge=o(2,function(n,t){var e=p.immediate(h(function(n,t,e,r){r[0]?e(r[0]()):n.hasVal?e(n.val):t.hasVal&&e(t.val)},[n,t]));return p.endsOn(h(function(){return!0},[n.end,t.end]),e),e}),p.transduce=o(2,function(n,t){return n=n(new T),h(function(t,e){var r=n["@@transducer/step"](void 0,t.val);return r&&!0===r["@@transducer/reduced"]?(e.end(!0),r["@@transducer/value"]):r},[t])}),p.curryN=o,p.fromPromise=function(n){var t=p.stream();return n.then(function(n){t(n),t.end(!0)}),t},p.flattenPromise=function(n){return h(function(n,t){n().then(t)},[n])},T.prototype["@@transducer/init"]=function(){},T.prototype["@@transducer/result"]=function(){},T.prototype["@@transducer/step"]=function(n,t){return t};const F=Object.assign||((n,t)=>(t&&Object.keys(t).forEach(e=>n[e]=t[e]),n)),J=(n,t,e)=>{const r=typeof e;if(e&&"object"===r)if(Array.isArray(e))for(const r of e)t=J(n,t,r);else for(const r of Object.keys(e)){const u=e[r];"function"==typeof u?t[r]=u(t[r],_):void 0===u?n&&!isNaN(r)?t.splice(r,1):delete t[r]:t[r]=null===u||"object"!=typeof u||Array.isArray(u)?u:"object"==typeof t[r]?u===t[r]?u:_(t[r],u):J(!1,{},u)}else"function"===r&&(t=e(t,_));return t},_=(n,...t)=>{const e=Array.isArray(n);return J(e,e?n.slice():F({},n),t)};var z=p.stream,B=p.scan;n.store=function(n){var t=z(),e=B(function(n,t){return _(n,t)},n,t);return Object.assign(e,{update:t})}});
//# sourceMappingURL=state.umd.js.map
