var n=function(n,t){switch(n){case 0:return function(){return t.apply(this,arguments)};case 1:return function(n){return t.apply(this,arguments)};case 2:return function(n,e){return t.apply(this,arguments)};case 3:return function(n,e,r){return t.apply(this,arguments)};case 4:return function(n,e,r,u){return t.apply(this,arguments)};case 5:return function(n,e,r,u,s){return t.apply(this,arguments)};case 6:return function(n,e,r,u,s,a){return t.apply(this,arguments)};case 7:return function(n,e,r,u,s,a,o){return t.apply(this,arguments)};case 8:return function(n,e,r,u,s,a,o,i){return t.apply(this,arguments)};case 9:return function(n,e,r,u,s,a,o,i,c){return t.apply(this,arguments)};case 10:return function(n,e,r,u,s,a,o,i,c,f){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},t=function(n){return null!=n&&"object"==typeof n&&!0===n["@@functional/placeholder"]},e=function(n){return function e(r){return 0===arguments.length||t(r)?e:n.apply(this,arguments)}},r=function e(r,u,s){return function(){for(var a=[],o=0,i=r,c=0;c<u.length||o<arguments.length;){var f;c<u.length&&(!t(u[c])||o>=arguments.length)?f=u[c]:(f=arguments[o],o+=1),a[c]=f,t(f)||(i-=1),c+=1}return i<=0?s.apply(this,a):n(i,e(r,a,s))}},u=function(n){return function r(u,s){switch(arguments.length){case 0:return r;case 1:return t(u)?r:e(function(t){return n(u,t)});default:return t(u)&&t(s)?r:t(u)?e(function(t){return n(t,s)}):t(s)?e(function(t){return n(u,t)}):n(u,s)}}}(function(t,u){return 1===t?e(u):n(t,r(t,[],u))});function s(){return!0}var a,o=[],i=[],c=-1,f=!1,d=!1,p={};function l(n,t){var e,r,u,a,o=j([],s);for(u=[],a=[],e=0;e<t.length;++e)void 0!==t[e]&&(u.push(t[e]),void 0!==t[e].end&&a.push(t[e].end));return(r=j(u,n)).depsChanged=[],r.fnArgs=r.deps.concat([r,r.depsChanged]),r.end=o,o.listeners.push(r),E(a,o),o.deps=a,V(r),r}function h(n,t){return l(function(t,e){e(n(t.val))},[t])}function v(n){return h(n,this)}function g(n){return n(this)}function y(n){return m(n,this)}function m(n,t){var e=p.stream(1),r=p.on(function(){var n=e()-1;e(n),n<=0&&e.end(!0)});r(t.end);var u=p.stream(),s=p.combine(function(t,s){u.end(!0);var a=n(t());e(e()+1),r(a.end),u=h(s,a)},[t]);return p.endsOn(e.end,s),s}function b(n,t){return l(function(n,t,e){e(n.val(t.val))},[t,n])}function A(n){return b(n,this)}function C(n){return b(this,n)}function O(){return"stream("+this.val+")"}function U(){function n(t){return 0===arguments.length?n.val:(N(t,n),n)}return n.hasVal=!1,n.val=void 0,n.updaters=[],n.listeners=[],n.queued=!1,n.end=void 0,n.ap=A,n["fantasy-land/map"]=n.map=v,n["fantasy-land/ap"]=C,n["fantasy-land/of"]=n.of=p.stream,n["fantasy-land/chain"]=n.chain=y,n.pipe=g,n.constructor=p.stream,n.toJSON=function(){return n.val},n.toString=O,n}function j(n,t){var e=U();return e.fn=t,e.deps=n,e.depsMet=!1,e.depsChanged=n.length>0?[]:void 0,e.shouldUpdate=!1,E(n,e),e}function V(n){if(!function(n){return n.end&&!0===n.end.val}(n)&&function(n){return!0===n.depsMet||function(n){return n.depsMet=n.deps.every(function(n){return n.hasVal}),n.depsMet}(n)}(n))if(void 0===a){a=n,n.depsChanged&&(n.fnArgs[n.fnArgs.length-1]=n.depsChanged);var t=n.fn.apply(n.fn,n.fnArgs);void 0!==t&&n(t),a=void 0,void 0!==n.depsChanged&&(n.depsChanged=[]),n.shouldUpdate=!1,!1===(f||d)&&q(),function(n){return n.listeners.some(function(n){return n.shouldUpdate})}(n)&&(d?n.listeners.forEach(function(n){n.shouldUpdate&&w(V,n)}):n(n.val))}else w(V,n)}function M(n){var t,e=n.listeners;if(!1===n.queued){for(n.queued=!0,t=0;t<e.length;++t)M(e[t]);i[++c]=n}}function w(n,t){o.push(t),t.updaters.push(n),t.shouldUpdate=!0}function q(){for(f=!0;o.length>0;){var n=o.shift(),t=n.updaters.shift();t&&n.shouldUpdate&&t(n)}f=!1}function N(n,t){t.val=n,t.hasVal=!0,void 0===a?(d=!0,function(n){var t,e,r,u=n.listeners;for(t=0;t<u.length;++t)(r=u[t]).end===n?x(r):(void 0!==r.depsChanged&&r.depsChanged.push(n),r.shouldUpdate=!0,M(r));for(;c>=0;--c)!0===(e=i[c]).shouldUpdate&&V(e),e.queued=!1}(t),o.length>0&&q(),d=!1):a===t?function(n,t){var e,r;for(e=0;e<t.length;++e)(r=t[e]).end!==n?(void 0!==r.depsChanged&&r.depsChanged.push(n),r.shouldUpdate=!0):x(r)}(t,t.listeners):w(function(t){N(n,t)},t)}function E(n,t){for(var e=0;e<n.length;++e)n[e].listeners.push(t)}function S(n,t){var e=t.indexOf(n);t[e]=t[t.length-1],t.length--}function k(n){for(var t=0;t<n.deps.length;++t)S(n,n.deps[t].listeners);n.deps.length=0}function x(n){void 0!==n.deps&&k(n),void 0!==n.end&&k(n.end)}function P(){}p.stream=function(n){var t=j([],s),e=U();return e.end=t,e.fnArgs=[],t.listeners.push(e),arguments.length>0&&e(n),e},p.stream["fantasy-land/of"]=p.stream.of=p.stream,p.combine=u(2,l),p.isStream=function(n){return!!((t=n)&&t.constructor&&t.call&&t.apply)&&"hasVal"in n;var t},p.immediate=function(n){return!1===n.depsMet&&(n.depsMet=!0,V(n)),n},p.endsOn=function(n,t){return k(t.end),n.listeners.push(t.end),t.end.deps.push(n),t},p.map=u(2,h),p.chain=u(2,m),p.ap=u(2,b),p.on=u(2,function(n,t){return l(function(t){n(t.val)},[t])}),p.scan=u(3,function(n,t,e){var r=l(function(e,r){r(t=n(t,e.val))},[e]);return r.hasVal||r(t),r}),p.merge=u(2,function(n,t){var e=p.immediate(l(function(n,t,e,r){r[0]?e(r[0]()):n.hasVal?e(n.val):t.hasVal&&e(t.val)},[n,t]));return p.endsOn(l(function(){return!0},[n.end,t.end]),e),e}),p.transduce=u(2,function(n,t){return n=n(new P),l(function(t,e){var r=n["@@transducer/step"](void 0,t.val);return r&&!0===r["@@transducer/reduced"]?(e.end(!0),r["@@transducer/value"]):r},[t])}),p.curryN=u,p.fromPromise=function(n){var t=p.stream();return n.then(function(n){t(n),t.end(!0)}),t},p.flattenPromise=function(n){return l(function(n,t){n().then(t)},[n])},P.prototype["@@transducer/init"]=function(){},P.prototype["@@transducer/result"]=function(){},P.prototype["@@transducer/step"]=function(n,t){return t};var F=p;const J=Object.assign||((n,t)=>(t&&Object.keys(t).forEach(e=>n[e]=t[e]),n)),_=(n,t,e)=>{const r=typeof e;if(e&&"object"===r)if(Array.isArray(e))for(const r of e)t=_(n,t,r);else for(const r of Object.keys(e)){const u=e[r];"function"==typeof u?t[r]=u(t[r],z):void 0===u?n&&!isNaN(r)?t.splice(r,1):delete t[r]:t[r]=null===u||"object"!=typeof u||Array.isArray(u)?u:"object"==typeof t[r]?u===t[r]?u:z(t[r],u):_(!1,{},u)}else"function"===r&&(t=e(t,z));return t},z=(n,...t)=>{const e=Array.isArray(n);return _(e,e?n.slice():J({},n),t)},{stream:B,scan:D}=F,G=n=>{const t=B(),e=D((n,t)=>z(n,t),n,t);return Object.assign(e,{update:t})};export{G as store};
//# sourceMappingURL=state.modern.js.map
